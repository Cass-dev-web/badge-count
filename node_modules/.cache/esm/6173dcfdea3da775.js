let tmi,BOT_AUTH,BOT_USER,CHANNELS;_ea3‍.w("tmi.js",[["default",["tmi"],function(v){tmi=v}]]);_ea3‍.w("./constants",[["BOT_AUTH",["BOT_AUTH"],function(v){BOT_AUTH=v}],["BOT_USER",["BOT_USER"],function(v){BOT_USER=v}],["CHANNELS",["CHANNELS"],function(v){CHANNELS=v}]]);

// Connecing stage
const client = new tmi.Client({options: { },identity: {username: BOT_USER,password: BOT_AUTH},channels: CHANNELS});
client.connect()
console.log("Connected ---------")
//Functions
function timeout(ms) {return new Promise(resolve => setTimeout(resolve, ms));}
function oppositeBool(bool) {return !bool}
function isMod(User) {return User.mod || User['user-type'] == 'mod'}
function reply(channel,username,reply){client.say(channel,"[BOT] @"+username+", "+reply)}
// Temporairy Variables
var killSwitch=false;
// Main Events
client.on('ready', async())
client.on('message', async (channel, user, message, self) => {
    await(timeout(100))//DEBUG:
    var lowerCaseMessage=message.toLocaleLowerCase();
    var username = user.username;

    // ------------------------
    
    _ea3‍.g.console.log(user.mod)
    //if(username=="parentprofanities"){return;}
    if((lowerCaseMessage=="=killswitch" || lowerCaseMessage=="=ks")&&isMod(user)){
        var killswitchOperand = oppositeBool(killSwitch)
        reply(channel,username,"kill switch turned "+(killswitchOperand) ==true ? "on" : "off" +".")
    }
    if(killSwitch==true){return}
    if(lowerCaseMessage=='hi'){
        reply(channel,username,"hi!")
    }

});